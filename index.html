<!DOCTYPE html>
<html lang="es">
    <meta charset="UTF-8">
    <head>
        <title>Juego de atrapar</title>
        <style>
            body {
                text-align: center;
                background-color: #222;
                color: white;
                font-family: sans-serif;
            }

            #gameArea {
                position: relative;
                width: 500px;
                height: 400px;
                background-color: #333;
                margin: 20px auto;
                border: 2px solid white;
            }

            #square {
                position: absolute;
                width: 50px;
                height: 50px;
                background-color: red;
                display: none;
                cursor: pointer;
            }
        </style>
    </head>
    <body>
        <h1>Atrapa el cuadrado</h1>
        <p>Haz click en el cuadrado rojo para ganar puntos</p>
        <div id="gameArea">
            <div id="square"></div>
        </div>
       <script>
            const square = document.getElementById("square");
            const gameArea = document.getElementById("gameArea");

            // --- Zona de puntuaciÃ³n ---
            const scoreDisplay = document.createElement("div");
            scoreDisplay.style.fontSize = "24px";
            scoreDisplay.style.marginTop = "10px";
            document.body.appendChild(scoreDisplay);

            // --- Zona de mensajes ---
            const messageBox = document.createElement("div");
            messageBox.style.marginTop = "10px";
            messageBox.style.color = "yellow";
            messageBox.style.minHeight = "24px";
            document.body.appendChild(messageBox);

            function showMessage(text, color = "yellow") {
                messageBox.textContent = text;
                messageBox.style.color = color;
                clearTimeout(showMessage.timeout);
                showMessage.timeout = setTimeout(() => (messageBox.textContent = ""), 2000);
            }

            // --- BotÃ³n de reinicio ---
            const resetButton = document.createElement("button");
            resetButton.textContent = "Reiniciar progreso";
            resetButton.style.marginTop = "10px";
            resetButton.style.display = "block";
            document.body.appendChild(resetButton);

            // --- Tienda ---
            const shop = document.createElement("div");
            shop.style.marginTop = "15px";
            document.body.appendChild(shop);

            // --- Variables del juego ---
            let score = 0;
            let hasWoodSword = false;
            let startTime;
            let timer;

            // --- Guardar/cargar progreso ---
            function loadProgress() {
                const savedScore = localStorage.getItem("score");
                const savedSword = localStorage.getItem("woodSword");
                if (savedScore) score = parseInt(savedScore);
                if (savedSword === "true") hasWoodSword = true;
                updateScore(0);
                updateShop();
            }

            function saveProgress() {
                localStorage.setItem("score", score);
                localStorage.setItem("woodSword", hasWoodSword);
            }

            // --- Mostrar cuadrado ---
            function showSquare() {
                const x = Math.random() * (gameArea.clientWidth - 50);
                const y = Math.random() * (gameArea.clientHeight - 50);
                square.style.left = `${x}px`;
                square.style.top = `${y}px`;
                square.style.display = "block";
                startTime = Date.now();

                timer = setTimeout(() => {
                    square.style.display = "none";
                    showSquare();
                    updateScore(0);
                }, 1500);
            }

            // --- Actualizar puntuaciÃ³n ---
            function updateScore(points) {
                score += points;
                scoreDisplay.textContent = `Monedas: ${score}`;
                saveProgress();
                updateShop();
            }

            // --- Tocar el cuadrado ---
            square.addEventListener("pointerdown", () => {
                const reaction = Date.now() - startTime;
                clearTimeout(timer);
                square.style.display = "none";

                let points = 0;
                if (reaction <= 600) points = 3;
                else if (reaction <= 1000) points = 2;
                else if (reaction <= 1500) points = 1;

                // ðŸ’¥ ESPADA: bonus por tenerla
                if (hasWoodSword) {
                    points += 1;
                }

                updateScore(points);
                showMessage(`+${points} monedas`, hasWoodSword ? "cyan" : "lime");
                showSquare();
            });

            // --- Tienda ---
            function updateShop() {
                shop.innerHTML = "";
                const sword = document.createElement("div");

                if (!hasWoodSword) {
                    sword.textContent = "ðŸªµ Espada de madera - Precio: 20 monedas";
                    const buyBtn = document.createElement("button");
                    buyBtn.textContent = "Comprar";
                    buyBtn.style.marginLeft = "10px";

                    buyBtn.onclick = () => {
                        if (score >= 20) {
                            score -= 20;
                            hasWoodSword = true;
                            updateScore(0);
                            showMessage("Â¡Has comprado la espada de madera!", "cyan");
                        } else {
                            showMessage("No tienes suficientes monedas.", "red");
                        }
                    };
                    sword.appendChild(buyBtn);
                } else {
                    sword.textContent = "âœ… Espada de madera (Activa: +1 moneda por toque)";
                    sword.style.color = "cyan";
                }
                shop.appendChild(sword);
            }

            // --- BotÃ³n de reinicio ---
            resetButton.addEventListener("click", () => {
                score = 0;
                hasWoodSword = false;
                localStorage.clear();
                updateScore(0);
                showMessage("Progreso reiniciado", "orange");
            });

            // --- Iniciar ---
            loadProgress();
            showSquare();
        </script>
    </body>
</html>   


